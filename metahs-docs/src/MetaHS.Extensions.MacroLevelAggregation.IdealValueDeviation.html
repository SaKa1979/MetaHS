<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : MetaHS.MacroLevelAggregation
Description : The MetaHS Macro-level aggregation method: ideal value deviation (IVD)
Copyright   : Copyright (C) 2017-2019 H.H.R.F. Vos, S. Kamps
License     : MIT
Maintainer  : hhrf.vos@studie.ou.nl, sanderkamps79@gmail.com
Stability   : experimental
Calculates the deviation to a supplied 'ideal value' in a range between
a lower and upper bound for the median of metric values corresponding to
supplied Relation Key. Result is a value bounded by [0,1].
Empirically determined values are:
LOC; low = -15, ideal = 69, upper = 269
LCOM: low = 0, ideal = 1, upper = 11
CBO: low = 0, ideal = 6, upper = 16
-}</span><span>
</span><a name="line-16"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">(</span><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#idealValueDeviation"><span class="hs-identifier hs-var">idealValueDeviation</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.Utils.html"><span class="hs-identifier">MetaHS.Extensions.MacroLevelAggregation.Utils</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.Median.html"><span class="hs-identifier">MetaHS.Extensions.MacroLevelAggregation.Median</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="MetaHS.DataModel.MetaModel.html"><span class="hs-identifier">MetaHS.DataModel.MetaModel</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MetaModel</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="MetaHS.EDSL.MetaModel.html"><span class="hs-identifier">MetaHS.EDSL.MetaModel</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- | Calculate the Ideal Value Deviation of the metric values associated with the supplied metric Relation key.</span><span>
</span><a name="line-26"></a><span class="hs-identifier">idealValueDeviation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MetaHS.EDSL.MetaModel.html#RelationKey"><span class="hs-identifier hs-type">RelationKey</span></a><span>          </span><span class="hs-comment">-- ^ The MetaModel Relation Key (E.g., LCOM).</span><span>
</span><a name="line-27"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#MetaModel"><span class="hs-identifier hs-type">MetaModel.MetaModel</span></a><span>  </span><span class="hs-comment">-- ^ The MetaModel Containing the associated key.</span><span>
</span><a name="line-28"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                  </span><span class="hs-comment">-- ^ The lower bound.</span><span>
</span><a name="line-29"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                  </span><span class="hs-comment">-- ^ The ideal value.</span><span>
</span><a name="line-30"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                  </span><span class="hs-comment">-- ^ The upper bound.</span><span>
</span><a name="line-31"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>               </span><span class="hs-comment">-- ^ The deviation from the ideal value.</span><span>
</span><a name="line-32"></a><a name="idealValueDeviation"><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#idealValueDeviation"><span class="hs-identifier">idealValueDeviation</span></a></a><span> </span><a name="local-6989586621679135608"><a href="#local-6989586621679135608"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679135609"><a href="#local-6989586621679135609"><span class="hs-identifier">mm</span></a></a><span> </span><a name="local-6989586621679135610"><a href="#local-6989586621679135610"><span class="hs-identifier">lowerBound</span></a></a><span> </span><a name="local-6989586621679135611"><a href="#local-6989586621679135611"><span class="hs-identifier">idealValue</span></a></a><span> </span><a name="local-6989586621679135612"><a href="#local-6989586621679135612"><span class="hs-identifier">upperBound</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#ivd"><span class="hs-identifier hs-var">ivd</span></a><span> </span><a href="#local-6989586621679135613"><span class="hs-identifier hs-var">ll</span></a><span> </span><a href="#local-6989586621679135614"><span class="hs-identifier hs-var">ideal</span></a><span> </span><a href="#local-6989586621679135615"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679135616"><span class="hs-identifier hs-var">med</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>  </span><a name="local-6989586621679135613"><a href="#local-6989586621679135613"><span class="hs-identifier">ll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679135610"><span class="hs-identifier hs-var">lowerBound</span></a><span>
</span><a name="line-35"></a><span>  </span><a name="local-6989586621679135614"><a href="#local-6989586621679135614"><span class="hs-identifier">ideal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679135611"><span class="hs-identifier hs-var">idealValue</span></a><span>
</span><a name="line-36"></a><span>  </span><a name="local-6989586621679135615"><a href="#local-6989586621679135615"><span class="hs-identifier">ul</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679135612"><span class="hs-identifier hs-var">upperBound</span></a><span>
</span><a name="line-37"></a><span>  </span><a name="local-6989586621679135616"><a href="#local-6989586621679135616"><span class="hs-identifier">med</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.Median.html#median"><span class="hs-identifier hs-var">median</span></a><span> </span><a href="#local-6989586621679135608"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679135609"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | Calculate the Ideal Value Deviation based on the supplied metric median.</span><span>
</span><a name="line-40"></a><span class="hs-identifier">ivd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The lower bound.</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The ideal value.</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The upper bound.</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The metric median to be evaluated.</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The deviation from the ideal value.</span><span>
</span><a name="line-45"></a><a name="ivd"><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#ivd"><span class="hs-identifier">ivd</span></a></a><span> </span><a name="local-6989586621679135617"><a href="#local-6989586621679135617"><span class="hs-identifier">ll</span></a></a><span> </span><a name="local-6989586621679135618"><a href="#local-6989586621679135618"><span class="hs-identifier">ideal</span></a></a><span> </span><a name="local-6989586621679135619"><a href="#local-6989586621679135619"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679135620"><a href="#local-6989586621679135620"><span class="hs-identifier">med</span></a></a><span>
</span><a name="line-46"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135617"><span class="hs-identifier hs-var">ll</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679135618"><span class="hs-identifier hs-var">ideal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#lowerThanIdeal"><span class="hs-identifier hs-var">lowerThanIdeal</span></a><span> </span><a href="#local-6989586621679135617"><span class="hs-identifier hs-var">ll</span></a><span> </span><a href="#local-6989586621679135618"><span class="hs-identifier hs-var">ideal</span></a><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135618"><span class="hs-identifier hs-var">ideal</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679135619"><span class="hs-identifier hs-var">ul</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#higherThanIdeal"><span class="hs-identifier hs-var">higherThanIdeal</span></a><span> </span><a href="#local-6989586621679135618"><span class="hs-identifier hs-var">ideal</span></a><span> </span><a href="#local-6989586621679135619"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679135617"><span class="hs-identifier hs-var">ll</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679135620"><span class="hs-identifier hs-var">med</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679135619"><span class="hs-identifier hs-var">ul</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | Calculate the Ideal Value Deviation when the metric median is between the lower bound and the ideal value.</span><span>
</span><a name="line-51"></a><span class="hs-identifier">lowerThanIdeal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The lower bound.</span><span>
</span><a name="line-52"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The ideal value.</span><span>
</span><a name="line-53"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The metric median to be evaluated.</span><span>
</span><a name="line-54"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The deviation from the ideal value.</span><span>
</span><a name="line-55"></a><a name="lowerThanIdeal"><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#lowerThanIdeal"><span class="hs-identifier">lowerThanIdeal</span></a></a><span> </span><a name="local-6989586621679135621"><a href="#local-6989586621679135621"><span class="hs-identifier">ll</span></a></a><span> </span><a name="local-6989586621679135622"><a href="#local-6989586621679135622"><span class="hs-identifier">ideal</span></a></a><span> </span><a name="local-6989586621679135623"><a href="#local-6989586621679135623"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679135623"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679135621"><span class="hs-identifier hs-var">ll</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679135622"><span class="hs-identifier hs-var">ideal</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679135621"><span class="hs-identifier hs-var">ll</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | Calculate the Ideal Value Deviation when the metric median is between the ideal value and the lower bound.</span><span>
</span><a name="line-58"></a><span class="hs-identifier">higherThanIdeal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The ideal value.</span><span>
</span><a name="line-59"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The upper bound.</span><span>
</span><a name="line-60"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The metric median to be evaluated.</span><span>
</span><a name="line-61"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ The deviation from the ideal value.</span><span>
</span><a name="line-62"></a><a name="higherThanIdeal"><a href="MetaHS.Extensions.MacroLevelAggregation.IdealValueDeviation.html#higherThanIdeal"><span class="hs-identifier">higherThanIdeal</span></a></a><span> </span><a name="local-6989586621679135624"><a href="#local-6989586621679135624"><span class="hs-identifier">ideal</span></a></a><span> </span><a name="local-6989586621679135625"><a href="#local-6989586621679135625"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679135626"><a href="#local-6989586621679135626"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679135626"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679135624"><span class="hs-identifier hs-var">ideal</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679135625"><span class="hs-identifier hs-var">ul</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679135624"><span class="hs-identifier hs-var">ideal</span></a><span class="hs-special">)</span><span class="hs-special">)</span></pre></body></html>