<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : MetaHS.Extensions
Description : The MetaHS LCOM aggregation
Copyright   : Copyright (C) 2017-2019 H.H.R.F. Vos, S. Kamps
License     : MIT
Maintainer  : hhrf.vos@studie.ou.nl, sanderkamps79@gmail.com
Stability   : experimental
Metamodel Element that is interesting (those that represents modules being imported) is :
Module. All other Elements that are part of the _contains relations are ignored.

CBO - Coupling between object classes
      The coupling between object classes (CBO) metric represents the number of classes coupled to a given class
      (efferent couplings, Ce).
      This coupling can occur through method calls, field accesses, inheritance, arguments, return types, and exceptions.
      ref. Chidamber and Kemerer (1994)
-}</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MetaHS.Extensions.CBO</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">(</span><a href="MetaHS.Extensions.CBO.html#keyCbo"><span class="hs-identifier hs-var">keyCbo</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><a href="MetaHS.Extensions.CBO.html#cboAggregator"><span class="hs-identifier hs-var">cboAggregator</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><a href="MetaHS.DataModel.MetaModel.html"><span class="hs-identifier">MetaHS.DataModel.MetaModel</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><a href="MetaHS.EDSL.MetaModel.html"><span class="hs-identifier">MetaHS.EDSL.MetaModel</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | MetaModel key used for the CBO relation.</span><span>
</span><a name="line-27"></a><span class="hs-identifier">keyCbo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MetaHS.EDSL.MetaModel.html#RelationKey"><span class="hs-identifier hs-type">RelationKey</span></a><span>
</span><a name="line-28"></a><a name="keyCbo"><a href="MetaHS.Extensions.CBO.html#keyCbo"><span class="hs-identifier">keyCbo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CBO&quot;</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- | CBO aggregator that adds the CBO metric relation to the supplied meta-model.</span><span>
</span><a name="line-31"></a><span class="hs-identifier">cboAggregator</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#MetaModel"><span class="hs-identifier hs-type">MetaModel</span></a><span> </span><span class="hs-comment">-- ^ The supplied meta-model.</span><span>
</span><a name="line-32"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#MetaModel"><span class="hs-identifier hs-type">MetaModel</span></a><span> </span><span class="hs-comment">-- ^ The complemented meta-model.</span><span>
</span><a name="line-33"></a><a name="cboAggregator"><a href="MetaHS.Extensions.CBO.html#cboAggregator"><span class="hs-identifier">cboAggregator</span></a></a><span> </span><a name="local-6989586621679134762"><a href="#local-6989586621679134762"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.EDSL.MetaModel.html#setRelation"><span class="hs-identifier hs-var">setRelation</span></a><span> </span><a href="MetaHS.Extensions.CBO.html#keyCbo"><span class="hs-identifier hs-var">keyCbo</span></a><span> </span><a href="#local-6989586621679134763"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span>    </span><a name="local-6989586621679134763"><a href="#local-6989586621679134763"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679134764"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">Set.empty</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679134766"><a href="#local-6989586621679134766"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679134766"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#Module"><span class="hs-identifier hs-var">Module</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;?&quot;</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MetaHS.EDSL.MetaModel.html#getModules"><span class="hs-identifier hs-var">getModules</span></a><span> </span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-36"></a><span>    </span><a name="local-6989586621679134764"><a href="#local-6989586621679134764"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679134767"><a href="#local-6989586621679134767"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679134767"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679134765"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621679134767"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><a name="local-6989586621679134765"><a href="#local-6989586621679134765"><span class="hs-identifier">lv</span></a></a><span> </span><a name="local-6989586621679134768"><a href="#local-6989586621679134768"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MetaHS.Extensions.CBO.html#calcCbo"><span class="hs-identifier hs-var">calcCbo</span></a><span> </span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">mm</span></a><span> </span><a href="#local-6989586621679134768"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-identifier">calcCbo</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-40"></a><span>     </span><a href="MetaHS.DataModel.MetaModel.html#MetaModel"><span class="hs-identifier hs-type">MetaModel</span></a><span class="hs-comment">-- ^ The meta-model.</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#Element"><span class="hs-identifier hs-type">Element</span></a><span>  </span><span class="hs-comment">-- ^ Module</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- ^ The calculated LCOM metric value.</span><span>
</span><a name="line-43"></a><a name="calcCbo"><a href="MetaHS.Extensions.CBO.html#calcCbo"><span class="hs-identifier">calcCbo</span></a></a><span> </span><a name="local-6989586621679134769"><a href="#local-6989586621679134769"><span class="hs-identifier">mm</span></a></a><span> </span><a name="local-6989586621679134770"><a href="#local-6989586621679134770"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679134771"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>    </span><a name="local-6989586621679134771"><a href="#local-6989586621679134771"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="MetaHS.Extensions.CBO.html#isInteresting"><span class="hs-identifier hs-var">isInteresting</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MetaHS.EDSL.MetaModel.html#moduleImports"><span class="hs-identifier hs-var">moduleImports</span></a><span> </span><a href="#local-6989586621679134769"><span class="hs-identifier hs-var">mm</span></a><span> </span><a href="#local-6989586621679134770"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | The Elements for which the CBO is measured.</span><span>
</span><a name="line-48"></a><span class="hs-identifier">isInteresting</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MetaHS.DataModel.MetaModel.html#Element"><span class="hs-identifier hs-type">Element</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-49"></a><a name="isInteresting"><a href="MetaHS.Extensions.CBO.html#isInteresting"><span class="hs-identifier">isInteresting</span></a></a><span> </span><a href="MetaHS.DataModel.MetaModel.html#Module"><span class="hs-identifier hs-var">Module</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-50"></a><span class="hs-identifier">isInteresting</span><span>  </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span></pre></body></html>